{"version":3,"sources":["/index.ts"],"names":[],"mappings":";;;;AAAA,6CAAuC;AACvC,oCAA4B;AAE5B,2CAA2C;AAC3C,gBAAK,CAAC,GAAG,CAAC,WAAW,EAAE,MAAM,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;AAEhD,gBAAG,CAAC,GAAG,CAAC;IACP,KAAK,EAAE,mBAAmB;CAC1B,CAAC,CAAC;AAGH,IAAI,IAAI,GAAG,CAAC,CAAC,YAAY,CAAC,CAAC;AAE3B,IAAI,QAAQ,GAAG,CAAC,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC;IAEnC,IAAI,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC;QAC7B,IAAI,EAAE;YACL,IAAI,EAAE,KAAK;YACX,OAAO,EAAE,IAAI;SACb;QACD,QAAQ,EAAE;YACT,IAAI,EAAE,IAAI;YACV,OAAO,EAAE,IAAI;SACb;KACD,CAAC,CAAC;IAEH,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;QACX,gBAAG,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,EAAE,UAAU,IAAI;YAClC,EAAE,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC;gBAEhB,IAAI,KAAG,GAAG,KAAK,CAAC,aAAoB;gBAEpC,IAAI,iBAAiB,GAAG,gBAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;gBAC1C,QAAQ,CAAC;gBACT,EAAE,CAAC,CAAC,iBAAiB,IAAI,iBAAiB,KAAK,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;oBAC3D,IAAI,IAAI,GAAG,gBAAG,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;oBACpC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;wBACV,KAAG,IAAI,IAAI,CAAC;oBACb,CAAC;gBACF,CAAC;gBAED,gBAAK,CAAC,GAAG,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;gBAE9B,CAAC,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;gBAExD,UAAU,CAAC;oBACV,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAG,CAAC,CAAC;gBAC9B,CAAC,EAAE,IAAI,CAAC,CAAC;YACV,CAAC;YACD,IAAI,CAAC,CAAC;gBACL,gBAAG,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;YACrB,CAAC;QACF,CAAC,CAAC,CAAC;IAEJ,CAAC;AACF,CAAC,CAAC,CAAC","file":"index.js","sourcesContent":["import {store} from 'ts/util/store.ts';\r\nimport opg from 'ts/opg.ts';\r\n\r\n//noinspection TypeScriptUnresolvedVariable\r\nstore.set('apiServer', window.CONFIG.apiServer);\r\n\r\nopg.api({\r\n\tlogin: 'Bll.Authen/SignIn',\r\n});\r\n\r\n\r\nlet form = $('#loginForm');\r\n\r\nlet btnLogin = $('#btnLogin').click(function () {\r\n\r\n\tlet param = form.fieldsToJson({\r\n\t\tname: {\r\n\t\t\tname: '用户名',\r\n\t\t\trequire: true,\r\n\t\t},\r\n\t\tpassword: {\r\n\t\t\tname: '密码',\r\n\t\t\trequire: true,\r\n\t\t},\r\n\t});\r\n\r\n\tif (param) {\r\n\t\topg.api.login(param, function (data) {\r\n\t\t\tif (data === 1) {\r\n\r\n\t\t\t\tlet url = __uri('./page/main.aspx');\r\n\r\n\t\t\t\tlet previousLoginName = store.get('user');\r\n\t\t\t\tdebugger;\r\n\t\t\t\tif (previousLoginName && previousLoginName === param.name) {\r\n\t\t\t\t\tlet hash = opg.request['ReturnUrl'];\r\n\t\t\t\t\tif (hash) {\r\n\t\t\t\t\t\turl += hash;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstore.set('user', param.name);\r\n\r\n\t\t\t\t$('#cycle').attr('stroke', '#ffffff').addClass('cycle');\r\n\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\twindow.location.replace(url);\r\n\t\t\t\t}, 1300);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\topg.err('用户名或密码错误');\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n});\r\n"]}