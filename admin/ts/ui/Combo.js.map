{"version":3,"sources":["/ts/ui/Combo.ts"],"names":[],"mappings":"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","file":"Combo.js","sourcesContent":["import {DisplayObject} from './DisplayOject';\r\n\r\nlet ComboManager = {\r\n\tzIndex: 999,\r\n\tinstances: {},\r\n\tremove: function (key) {\r\n\t\tdelete this.instances[key];\r\n\t},\r\n\tcloseAll: function () {\r\n\t\tfor (let key in this.instances) {\r\n\t\t\tlet target: Combo = this.instances[key] as Combo;\r\n\t\t\tif (target.status === 'opened') target.close();\r\n\t\t}\r\n\t}\r\n};\r\n\r\nconst $BODY = $(\"body\");\r\n\r\nfunction bodyBinder() {\r\n\t$BODY.on(\"mousedown.dropDownHide\", function () {\r\n\t\tComboManager.closeAll();\r\n\t});\r\n}\r\n\r\n\r\nclass Combo extends DisplayObject {\r\n\r\n\tjqValueField :JQuery; //to put value\r\n\r\n\ttarget: JQuery; //drop down\r\n\r\n\t//EVENTS\r\n\tonBeforeOpen?: Function;\r\n\tonOpen?: Function;\r\n\tonClose?: Function;\r\n\r\n\tprivate _state: 'closed'|'opened';\r\n\t//private _wrapper?: JQuery;\r\n\tprivate _evtName: string ;\r\n\r\n\r\n\tconstructor(jq: JQuery, cfg: any) {\r\n\t\tcfg = $.extend({}, cfg);\r\n\r\n\t\tsuper(jq, cfg);\r\n\r\n\t}\r\n\r\n\tinit(jq: JQuery, cfg: any) {\r\n\t\tthis._evtName = 'mousedown.ComboEvent';\r\n\r\n\t\tif (jq[0].tagName === 'INPUT') jq.addClass('combo-input').val(cfg.text);\r\n\t\telse jq.text(cfg.text);\r\n\r\n\t\tthis.jqValueField = $(cfg.valueField);\r\n\r\n\t\tthis.target = cfg.target; //drop down\r\n\r\n\t\tthis.target.addClass('combo-dropDown').on('mousedown', (evt) => {\r\n\t\t\tevt.stopPropagation();\r\n\t\t});\r\n\r\n\t\t//EVENTS\r\n\t\tthis.onBeforeOpen = cfg.onBeforeOpen;\r\n\t\tthis.onOpen = cfg.onOpen;\r\n\t\tthis.onClose = cfg.onClose;\r\n\r\n\t\t//ereaser\r\n\t\tif (cfg.allowBlank) {\r\n\t\t\tCombo.makeClearableInput(this.jq , this.jqValueField);\r\n\t\t}\r\n\r\n\t\tComboManager.instances[this.guid] = this;\r\n\t\tthis.enable = true;\r\n\t}\r\n\r\n\tpublic static makeClearableInput(ipt :JQuery , valueIpt:JQuery) :void{\r\n\t\tlet isIE = $.detectIE();\r\n\t\tif(isIE && (isIE>10) && !ipt.prop('readonly')){\r\n\t\t\t//do nothing\r\n\t\t}\r\n\t\telse{\r\n\t\t\tlet wrapper = ipt.css({\r\n\t\t\t\tfloat: 'left',\r\n\t\t\t\tmargin: 0\r\n\t\t\t}).wrap('<span class=\"sp-eraserWrap\"></span>').parents('span:first');\r\n\r\n\t\t\tlet eraser = $('<div class=\"ipt-eraser\">&times;</div>')\r\n\t\t\t\t.appendTo(wrapper)\r\n\t\t\t\t.click(function () {\r\n\t\t\t\t\tif (!ipt.prop('disabled')) {\r\n\t\t\t\t\t\tipt.val('');\r\n\t\t\t\t\t\tvalueIpt.val('');\r\n\t\t\t\t\t\teraser.hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\twrapper.hover(function () {\r\n\t\t\t\tif(!ipt.prop('disabled') && ipt.val()){\r\n\t\t\t\t\tif(eraser.is(':visible'))\r\n\t\t\t\t\t\teraser.hide();\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\teraser.show();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tset enable(b: boolean) {\r\n\t\tif (b) {\r\n\t\t\tlet that = this,\r\n\t\t\t\t$c = this.target;\r\n\r\n\t\t\tthis.jq.on(this._evtName, function () {\r\n\t\t\t\t//event.stopImmediatePropagation();\r\n\t\t\t\tlet go = true;\r\n\t\t\t\tthat.status === \"closed\" && that.position();\r\n\r\n\t\t\t\tif (typeof that.onBeforeOpen === 'function') {\r\n\t\t\t\t\tgo = that.onBeforeOpen.apply(that);\r\n\t\t\t\t\tif (go === false) return that;\r\n\t\t\t\t}\r\n\t\t\t\t$c.stop(true, true).slideToggle(90, function () {\r\n\t\t\t\t\tif ($c.css(\"display\") === 'block') that.status = 'opened';\r\n\t\t\t\t\telse that.status = 'closed';\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn that;\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.jq.off(this._evtName).prop(\"disabled\", true);\r\n\t\t\tthis.target.hide();\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\t}\r\n\r\n\tposition() {\r\n\t\tlet $t = this.jq,  //input\r\n\t\t\t$c = this.target, //drop down\r\n\t\t\toffset = $t.offset();\r\n\r\n\t\tlet top = offset.top + $t.outerHeight(), ch = $c.outerHeight();\r\n\r\n\t\tif (top + ch > $(document).outerHeight() && offset.top > ch) {\r\n\t\t\ttop = offset.top - $c.outerHeight();\r\n\t\t}\r\n\r\n\t\t$c.css({\r\n\t\t\ttop: top,\r\n\t\t\tleft: offset.left,\r\n\t\t\tzIndex: ComboManager['zIndex']++\r\n\t\t});\r\n\t}\r\n\r\n\topen() {\r\n\t\tif (typeof this.onBeforeOpen === 'function') {\r\n\t\t\tlet go = this.onBeforeOpen();\r\n\t\t\tif (go === false) return this;\r\n\t\t}\r\n\t\tthis.position();\r\n\t\tthis.target.stop(true, true).slideDown(90);\r\n\t\tthis.status = 'opened';\r\n\t}\r\n\r\n\tclose() {\r\n\t\tthis.target.stop(true, true).slideUp(90);\r\n\t\tthis.status = 'closed';\r\n\t}\r\n\r\n\r\n\tset status(s: string) {\r\n\t\tif (s === 'opened') {\r\n\t\t\tthis._state = 'opened';\r\n\t\t\tbodyBinder();\r\n\r\n\t\t\tthis.target.on('mouseleave.dropDownHide', bodyBinder)\r\n\t\t\t\t.on('mouseenter.dropDownHide', function () {\r\n\t\t\t\t\t$BODY.off('.dropDownHide');\r\n\t\t\t\t});\r\n\r\n\t\t\tif (typeof this.onOpen === 'function') this.onOpen.apply(this, arguments);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._state = 'closed';\r\n\t\t\t$BODY.off('.dropDownHide');\r\n\t\t\tthis.target.off('.dropDownHide');\r\n\r\n\t\t\tif (typeof this.onClose === 'function') this.onClose.apply(this, arguments);\r\n\t\t}\r\n\t}\r\n\r\n\tget status(): string {\r\n\t\treturn this._state;\r\n\t}\r\n\r\n\r\n\tsetValue(txt , val) {\r\n\t\tthis.jq.val(txt);\r\n\t\tthis.jqValueField.val(val);\r\n\t}\r\n\r\n\tget text(): string {\r\n\t\treturn $.trim(this.jq.val());\r\n\t}\r\n}\r\n\r\n\r\ninterface ICanPutIntoCombo {\r\n\tsyncData(current: any)\r\n}\r\n\r\n\r\nexport {Combo, ICanPutIntoCombo};"]}