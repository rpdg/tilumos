{"version":3,"sources":["/ts/util/store.ts"],"names":[],"mappings":"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","file":"store.js","sourcesContent":["let storage: Storage = window.localStorage;\r\n\r\nconst deserialize = (value: string|any): any => {\r\n\tif (typeof value != 'string') {\r\n\t\treturn undefined;\r\n\t}\r\n\ttry {\r\n\t\treturn JSON.parse(value);\r\n\t}\r\n\tcatch (e) {\r\n\t\treturn value || undefined;\r\n\t}\r\n};\r\n\r\nconst store = {\r\n\tuse: (storageType: 'localStorage'|'sessionStorage') => {\r\n\t\tstorage = window[storageType];\r\n\t\treturn store;\r\n\t},\r\n\tget: (key: string, defaultVal?: any): any => {\r\n\t\tlet val = deserialize(storage.getItem(key));\r\n\t\treturn (val === undefined ? defaultVal : val);\r\n\t},\r\n\tset: (key: string, val: any) => {\r\n\t\tif (val === undefined) {\r\n\t\t\treturn store.remove(key);\r\n\t\t}\r\n\t\tstorage.setItem(key, JSON.stringify(val));\r\n\t\treturn val;\r\n\t},\r\n\tremove: (key: string) => {\r\n\t\tstorage.removeItem(key);\r\n\t},\r\n\tclear: () => {\r\n\t\tstorage.clear();\r\n\t},\r\n\teach: function (callback: Function) {\r\n\t\tfor (let i = 0, l = storage.length; i < l; i++) {\r\n\t\t\tlet key: string = storage.key(i);\r\n\t\t\tcallback(key, store.get(key));\r\n\t\t}\r\n\t}\r\n};\r\n\r\n\r\nclass LocalStore {\r\n\tprivate storage: Storage;\r\n\r\n\tconstructor(inSession: boolean = true) {\r\n\t\tthis.storage = window[inSession ? 'sessionStorage' : 'localStorage'];\r\n\t}\r\n\r\n\tget(key: string, defaultVal?: any): any {\r\n\t\tlet val = deserialize(this.storage.getItem(key));\r\n\t\treturn (val === undefined ? defaultVal : val);\r\n\t}\r\n\r\n\tset(key: string, val: any) {\r\n\t\tif (val === undefined) {\r\n\t\t\treturn this.remove(key);\r\n\t\t}\r\n\t\tthis.storage.setItem(key, JSON.stringify(val));\r\n\t\treturn val;\r\n\t}\r\n\r\n\tremove(key: string) {\r\n\t\tthis.storage.removeItem(key);\r\n\t}\r\n}\r\n\r\nclass Cache{\r\n\tprivate static instance :Cache ;\r\n\tprivate cache :any ;\r\n\r\n\tprivate constructor(){\r\n\t\tif(!top.window['__Cache'])\r\n\t\t\ttop.window['__Cache'] = {};\r\n\r\n\t\tthis.cache = top.window['__Cache'] ;\r\n\t}\r\n\r\n\tstatic getInstance(){\r\n\t\tif(!Cache.instance)\r\n\t\t\tCache.instance = new Cache();\r\n\t\treturn Cache.instance ;\r\n\t}\r\n\tstatic empty(){\r\n\t\tif(top.window['__Cache'])\r\n\t\t\ttop.window['__Cache'] = null;\r\n\t}\r\n\r\n\tget(key: string, defaultVal?: any): any {\r\n\t\tlet val = this.cache[key];\r\n\t\treturn (val === undefined ? defaultVal : val);\r\n\t}\r\n\r\n\tset(key: string, val: any) {\r\n\t\tif (val === undefined) {\r\n\t\t\treturn this.remove(key);\r\n\t\t}\r\n\t\tthis.cache[key] = val;\r\n\t}\r\n\tremove(key: string) {\r\n\t\tdelete this.cache[key];\r\n\t}\r\n}\r\n\r\nexport {store, LocalStore , Cache};"]}