{"version":3,"sources":["/ts/ui/Popup.ts"],"names":[],"mappings":"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","file":"Popup.js","sourcesContent":["import {DisplayObject} from './DisplayOject';\r\nimport {is} from '../util/utils'\r\n\r\nconst DEFAULTS = {\r\n\tcallback: null,\r\n\ttitle: null,           // titlebar text. titlebar will not be visible if not set.\r\n\tbtnClose: true,           // display close link in titlebar?\r\n\tbtnMax: false,           // display max link in titlebar?\r\n\tdrag: true,           // can this dialog be dragged?\r\n\tmodal: true,          // make dialog modal?\r\n\tshow: true,           // show dialog immediately?\r\n\tdestroy: true,          // should this dialog be removed from the DOM after being hidden?\r\n\tonClose: null,        // callback fired after dialog is hidden. executed in context of Boxy instance.\r\n\tonDestroy: null,\r\n\tbuttons: null\r\n};\r\n\r\nconst BoxyStore = {\r\n\tmanager: [],\r\n\tmanagerHash: {},\r\n\tdragging: null,\r\n\t_handleDrag: (evt) => {\r\n\t\t//evt.preventDefault() ;\r\n\t\tlet d = BoxyStore.dragging;\r\n\r\n\t\tif (d) {\r\n\r\n\t\t\tlet w = evt.pageX - d[1];\r\n\t\t\tlet h = evt.pageY - d[2];\r\n\r\n\t\t\tif (w < 1) w = 1;\r\n\t\t\telse if (w > d[3]) w = d[3];\r\n\r\n\t\t\tif (h < 1) h = 1;\r\n\t\t\telse if (h > d[4]) h = d[4];\r\n\r\n\t\t\td[0].style.cssText += ';left:' + w + 'px;top:' + h + 'px;';\r\n\r\n\t\t}\r\n\t}\r\n};\r\n\r\nconst nextZ = (() => {\r\n\tlet zIndex = 1000;\r\n\treturn () => ++zIndex;\r\n})();\r\n\r\n\r\nconst returnFalse = () => false;\r\n\r\n\r\nfunction setTitleBar(cfg) {\r\n\tlet self = this;\r\n\tlet tb = this.titleBar = $(`<div class=\"dg-title\">${cfg.title}</div>`);\r\n\tthis.boxy.append(this.titleBar);\r\n\ttb[0].onselectstart = returnFalse;\r\n\r\n\tlet btnSets = $('<div class=\"dg-title-buttons\"></div>').appendTo(tb);\r\n\r\n\tif (cfg.btnMax) {\r\n\t\tthis.btnMax = $(\"<b class='dg-btn-max'></b>\");\r\n\t\tbtnSets.append(this.btnMax);\r\n\t\tthis.btnMax.on('click', function () {\r\n\t\t\tself.toggle();\r\n\t\t});\r\n\t}\r\n\tif (cfg.btnClose) {\r\n\t\tthis.btnClose = $(\"<b class='dg-btn-x'></b>\");\r\n\t\tbtnSets.append(this.btnClose);\r\n\r\n\t\tthis.btnClose.on('click', function () {\r\n\t\t\tself.close();\r\n\t\t});\r\n\t}\r\n\r\n\tif (cfg.drag) {\r\n\t\tsetDraggable.call(this, this, cfg);\r\n\t}\r\n\r\n\t$('<div class=\"row tb-row\" />').prependTo(this.boxy).append(tb);\r\n\r\n\r\n}\r\n\r\n\r\nfunction setDraggable(self) {\r\n\tlet tb = self.titleBar;\r\n\r\n\ttb.on('mousedown', function (evt) {\r\n\t\tself.toTop();\r\n\r\n\t\tif (evt.target.tagName === 'B') return;\r\n\r\n\t\tif (evt.button < 2 && self.state !== \"max\") {\r\n\r\n\t\t\ttb.on('mousemove.boxy', function (e) {\r\n\t\t\t\ttb.unbind(\"mousemove.boxy\");\r\n\r\n\t\t\t\tlet boxy = self.boxy[0];\r\n\r\n\r\n\t\t\t\tdocument.onselectstart = returnFalse;\r\n\r\n\t\t\t\tlet size = self.getSize();\r\n\r\n\t\t\t\tBoxyStore.dragging = [\r\n\t\t\t\t\tboxy,\r\n\t\t\t\t\te.pageX - boxy.offsetLeft,\r\n\t\t\t\t\te.pageY - boxy.offsetTop,\r\n\t\t\t\t\tdocument.body.scrollWidth - size.width,\r\n\t\t\t\t\tdocument.body.scrollHeight - size.height\r\n\t\t\t\t];\r\n\r\n\t\t\t\t$(document)\r\n\t\t\t\t\t.bind(\"mousemove.boxy\", BoxyStore._handleDrag)\r\n\t\t\t\t\t.bind(\"mouseup.boxy\", function () {\r\n\t\t\t\t\t\tif (self.state !== \"max\" && BoxyStore.dragging) {\r\n\t\t\t\t\t\t\t$(document).unbind(\".boxy\");\r\n\t\t\t\t\t\t\tBoxyStore.dragging = document.onselectstart = null;\r\n\r\n\t\t\t\t\t\t\tlet pos = self.boxy.position();\r\n\t\t\t\t\t\t\tself.restoreSize.top = pos.top;\r\n\t\t\t\t\t\t\tself.restoreSize.left = pos.left;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t}\r\n\r\n\t\ttb.on(\"mouseup.boxy\", function () {\r\n\t\t\ttb.unbind(\".boxy\");\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nfunction setFooter(cfg) {\r\n\tlet footer = this.footBar = $('<div class=\"dg-footer\"></div>');\r\n\r\n\tlet htmlArr = [];\r\n\tfor (let key in cfg.buttons) {\r\n\t\tlet v = cfg.buttons[key], x = htmlArr.length;\r\n\r\n\t\tlet cls, txt;\r\n\r\n\t\tif (typeof v === 'string') {\r\n\t\t\tcls = (x === 0 ? 'btn-primary' : '');\r\n\t\t\ttxt = v;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcls = v.className || '';\r\n\t\t\ttxt = v.text || '';\r\n\r\n\t\t\tif(typeof v.onClick === 'function'){\r\n\t\t\t\tif(!cfg.callback){\r\n\t\t\t\t\tcfg.callback = function () {};\r\n\t\t\t\t}\r\n\t\t\t\tcfg.callback[key] = v.onClick;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\thtmlArr.push(`<button class=\"${cls}\" name=\"${x}\" data-key=\"${key}\">${txt}</button>`);\r\n\t}\r\n\r\n\tfooter.html(htmlArr.join(' '));\r\n\r\n\r\n\tlet self = this;\r\n\tfooter.on('click', 'button', function (evt) {\r\n\t\tlet keepOpen = false;\r\n\r\n\t\tif (cfg.callback) {\r\n\t\t\tlet clicked = this;\r\n\t\t\tlet btnKey = $(this).data('key');\r\n\t\t\tlet ifrWin = null;\r\n\t\t\tif (self.iframe) {\r\n\t\t\t\tifrWin = self.iframe.contentWindow ? self.iframe.contentWindow : self.iframe.contentDocument.defaultView;\r\n\t\t\t}\r\n\r\n\t\t\tlet i = parseInt(clicked.name, 10);\r\n\r\n\r\n\t\t\tif(btnKey && (typeof cfg.callback[btnKey] === 'function')){\r\n\t\t\t\tkeepOpen = cfg.callback[btnKey].call(self, i, ifrWin, clicked);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tkeepOpen = cfg.callback.call(self, i, ifrWin, clicked);\r\n\t\t\t}\r\n\r\n\r\n\t\t}\r\n\r\n\t\tif (!keepOpen) self.close();\r\n\t});\r\n\r\n\t$('<div class=\"row tf-row\" />').appendTo(this.boxy).append(footer);\r\n}\r\n\r\nclass PopUp extends DisplayObject {\r\n\r\n\tcfg: any;\r\n\tstate: string;\r\n\trestoreSize: any;\r\n\tvisible: boolean;\r\n\tmask: JQuery;\r\n\tboxy: JQuery;\r\n\ttitleBar ?: JQuery;\r\n\tfootBar ?: JQuery;\r\n\tcontent: JQuery;\r\n\tbtnMax ?: JQuery;\r\n\tbtnClose ?: JQuery;\r\n\tiframe ?: HTMLIFrameElement;\r\n\r\n\tconstructor(jq: JQuery, cfg: any) {\r\n\r\n\t\tcfg = $.extend({}, DEFAULTS, cfg);\r\n\r\n\t\tsuper(jq, cfg);\r\n\r\n\t\tBoxyStore.manager.push(this);\r\n\r\n\t\tif (cfg.popId) {\r\n\t\t\tif (cfg.popId in BoxyStore.managerHash)\r\n\t\t\t\tthrow new Error(`Duplicated PopId \"${cfg.popId}\"`);\r\n\t\t\telse\r\n\t\t\t\tBoxyStore.managerHash[cfg.popId] = this;\r\n\t\t}\r\n\t}\r\n\r\n\tinit(jq: JQuery, cfg: any) {\r\n\t\tsuper.init(jq, cfg);\r\n\t\tthis.cfg = cfg;\r\n\t}\r\n\r\n\tcreate(jq, cfg) {\r\n\t\tthis.state = 'normal';\r\n\t\tthis.visible = false;\r\n\r\n\t\tthis.mask = $('<div class=\"dg-mask\"></div>');\r\n\t\tthis.boxy = $('<div class=\"dg-wrapper\" id=\"' + ('dialog_' + DisplayObject.guid() ) + '\"></div>');\r\n\t\tthis.content = $('<div class=\"dg-content\"></div>');\r\n\r\n\r\n\t\tthis.content.append(jq);\r\n\t\tthis.boxy.append(this.content).appendTo(document.body);\r\n\r\n\r\n\t\tlet titleBarHeight = 0, footBarHeight = 0;\r\n\r\n\t\tif (cfg.title) {\r\n\t\t\tsetTitleBar.call(this, cfg);\r\n\t\t\ttitleBarHeight = this.titleBar.outerHeight();\r\n\t\t\tthis.boxy.find('.tb-row').css({height: titleBarHeight});\r\n\t\t}\r\n\r\n\t\tif (cfg.buttons) {\r\n\t\t\tsetFooter.call(this, cfg);\r\n\t\t\tthis.boxy.find('.tf-row').css({height: this.footBar.outerHeight()});\r\n\t\t\tfootBarHeight = this.footBar.outerHeight();\r\n\t\t}\r\n\r\n\t\tif (this.jq[0].tagName === 'IFRAME')\r\n\t\t\tthis.iframe = this.jq[0] as HTMLIFrameElement;\r\n\r\n\r\n\t\tlet contentSize = {\r\n\t\t\twidth: cfg.width || this.boxy.outerWidth() || 500,\r\n\t\t\theight: cfg.height || this.boxy.outerHeight() || 300\r\n\t\t};\r\n\r\n\t\t/*//console.log(size);\r\n\t\t this.boxy.css(contentSize);*/\r\n\r\n\r\n\t\tlet doc = document.documentElement;//, win = window;\r\n\r\n\t\tlet viewport = {\r\n\t\t\t//top: win.pageYOffset,\r\n\t\t\t//left: win.pageXOffset,\r\n\t\t\twidth: doc.clientWidth,\r\n\t\t\theight: doc.clientHeight\r\n\t\t};\r\n\t\t//console.log(p);\r\n\r\n\t\tlet pos = {\r\n\t\t\twidth: cfg.width || this.boxy.outerWidth() || 500,\r\n\t\t\theight: cfg.height || this.boxy.outerHeight() || 300,\r\n\t\t\ttop: Math.max(0, (viewport.height - contentSize.height ) / 2),\r\n\t\t\tleft: Math.max(0, (viewport.width - contentSize.width) / 2)\r\n\t\t};\r\n\r\n\r\n\t\tthis.boxy.css(pos);\r\n\r\n\t\tthis.restoreSize = pos;\r\n\r\n\t\t//console.warn(this.restoreSize);\r\n\r\n\t\tthis.mask.append(this.boxy.css({visibility: 'visible'})).appendTo(document.body);\r\n\r\n\r\n\t\tthis.toTop();\r\n\r\n\t\tif (navigator.userAgent.indexOf('Firefox') > -1 && this.iframe) {\r\n\t\t\tjq.css({height: contentSize.height - titleBarHeight - footBarHeight - 2});\r\n\t\t}\r\n\r\n\t\tif (cfg.show) this.open();\r\n\r\n\t}\r\n\r\n\tgetSize() {\r\n\t\treturn {\r\n\t\t\twidth: this.boxy.outerWidth(),\r\n\t\t\theight: this.boxy.outerHeight()\r\n\t\t}\r\n\t}\r\n\r\n\tgetPosition(): any {\r\n\t\tlet b = this.boxy[0];\r\n\t\treturn {left: b.offsetLeft, top: b.offsetTop};\r\n\t}\r\n\r\n\ttoTop() {\r\n\t\tthis.mask.css({zIndex: nextZ()});\r\n\t\treturn this;\r\n\t}\r\n\r\n\topen() {\r\n\r\n\t\tthis.boxy.stop(true, true);\r\n\r\n\t\tif (this.visible) {\r\n\t\t\treturn this.toTop();\r\n\t\t}\r\n\r\n\t\tthis.mask.css({display: \"block\", opacity: 1});\r\n\r\n\t\tlet topPx = this.boxy.position().top;\r\n\r\n\t\t//console.warn(this.boxy[0], topPx);\r\n\r\n\t\tthis.boxy.css({top: topPx - 20, opacity: 0}).animate({opacity: 1, top: topPx}, 200);\r\n\r\n\t\tthis.visible = true;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tclose(fn?: Function) {\r\n\r\n\t\tlet that = this;\r\n\t\tlet css = this.getPosition();\r\n\t\tcss.opacity = 0;\r\n\t\tcss.top = Math.max(css.top - 40, 0);\r\n\r\n\t\tthis.mask.animate({opacity: 0}, 200);\r\n\r\n\t\tthis.boxy.stop(true, true).animate(css, 300, function () {\r\n\r\n\r\n\t\t\tif (typeof that.cfg.onClose === 'function')\r\n\t\t\t\tthat.cfg.onClose.call(that);\r\n\r\n\t\t\tif (typeof fn === 'function')\r\n\t\t\t\tfn.call(that);\r\n\r\n\r\n\t\t\tif (that.cfg.destroy)\r\n\t\t\t\tthat.destroy.call(that);\r\n\t\t\telse{\r\n\t\t\t\tthat.visible = false;\r\n\t\t\t\tthat.boxy.css({top: css.top + 40});\r\n\t\t\t\tthat.mask.css({display: 'none'});\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tmax() {\r\n\t\t//resize window entity\r\n\t\tthis.boxy.stop(true, true).css({\r\n\t\t\tleft: 0,\r\n\t\t\ttop: 0,\r\n\t\t\twidth: '100%',\r\n\t\t\theight: '100%'\r\n\t\t});\r\n\r\n\r\n\t\tif (this.btnMax)\r\n\t\t\tthis.btnMax.toggleClass('dg-btn-max dg-btn-restore');\r\n\r\n\t\t//$(document.body).addClass('no-scroll');\r\n\r\n\t\tthis.state = 'max';\r\n\t\treturn this;\r\n\t}\r\n\r\n\trestore() {\r\n\r\n\r\n\t\tthis.boxy.stop(true, true).css(this.restoreSize);\r\n\r\n\r\n\t\tif (this.btnMax)\r\n\t\t\tthis.btnMax.toggleClass('dg-btn-max dg-btn-restore');\r\n\r\n\t\t//$(document.body).removeClass('no-scroll');\r\n\r\n\t\tthis.state = 'normal';\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\tdestroy() {\r\n\r\n\t\tif (this.titleBar) {\r\n\t\t\tthis.titleBar.off('mousedown');\r\n\t\t\tif (this.btnMax) this.btnMax.off('click');\r\n\t\t\tif (this.btnClose) this.btnClose.off('click');\r\n\t\t}\r\n\t\tif (this.footBar)\r\n\t\t\tthis.footBar.off('click');\r\n\r\n\t\tthis.mask.remove();\r\n\r\n\t\t/*fix the IE 9- 11 bug\r\n\t\tsee:  http://stackoverflow.com/questions/8978235/why-can-i-sometimes-not-type-into-my-input-in-ie\r\n\t\t& http://stackoverflow.com/questions/19150008/ie-9-and-ie-10-cannot-enter-text-into-input-text-boxes-from-time-to-time\r\n\t\t*/\r\n\t\tif(is.UsingIE){\r\n\t\t\tlet tp = $('<input type=\"text\" style=\"opacity: 0;\" />').appendTo('body').focus();\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\ttp.remove();\r\n\t\t\t\ttp = null;\r\n\t\t\t} , 20) ;\r\n\t\t}\r\n\r\n\r\n\r\n\t\tBoxyStore.manager.splice(BoxyStore.manager.indexOf(this), 1);\r\n\r\n\t\tif (this.cfg.popId) {\r\n\t\t\tdelete BoxyStore.managerHash[this.cfg.popId];\r\n\t\t}\r\n\r\n\t\tif (typeof this.cfg.onDestroy === 'function') {\r\n\t\t\tthis.cfg.onDestroy.call(this);\r\n\t\t}\r\n\t}\r\n\r\n\ttoggle() {\r\n\t\tif (this.state === 'normal') {\r\n\t\t\tthis.max();\r\n\r\n\t\t\tif (navigator.userAgent.indexOf('Firefox') > -1 && this.iframe) {\r\n\t\t\t\tthis.iframe.style.cssText += 'height: ' + (this.boxy.outerHeight() - this.titleBar.outerHeight() - 2 - (this.footBar ? this.footBar.outerHeight() : 0)) + 'px; ';\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.restore();\r\n\r\n\t\t\tif (navigator.userAgent.indexOf('Firefox') > -1 && this.iframe) {\r\n\t\t\t\tthis.iframe.style.cssText += 'height: ' + (this.restoreSize.height - this.titleBar.outerHeight() - 2 - (this.footBar ? this.footBar.outerHeight() : 0)) + 'px; ';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\treturn this;\r\n\t}\r\n\r\n\r\n\tstatic alert(message, callback, options = {}): PopUp {\r\n\r\n\t\tlet {html, cfg} = wrapAsk(message, callback, options);\r\n\r\n\t\treturn new PopUp($(html), cfg);\r\n\t}\r\n\r\n\tstatic confirm(message, callback, options = {}): PopUp {\r\n\r\n\t\tlet {html, cfg} = wrapAsk(message, callback, options);\r\n\r\n\t\tif (!cfg.buttons.cancel) {\r\n\t\t\tcfg.buttons.cancel = '取消';\r\n\t\t}\r\n\r\n\t\tcfg.callback = function (i, ifrWin) {\r\n\t\t\tif (i === 0) return callback.call(this, i, ifrWin);\r\n\t\t\treturn void(0);\r\n\t\t};\r\n\r\n\t\treturn new PopUp($(html), cfg);\r\n\t}\r\n\r\n\tstatic popTop(iframe, options): PopUp {\r\n\t\t//noinspection TypeScriptUnresolvedFunction\r\n\t\treturn top.opg(iframe).popup(options);\r\n\t}\r\n\r\n\tstatic closeLast() {\r\n\t\tif (BoxyStore.manager.length > 0) {\r\n\t\t\tlet pop = BoxyStore.manager[BoxyStore.manager.length - 1] as PopUp;\r\n\t\t\treturn pop.close();\r\n\t\t}\r\n\t\telse\r\n\t\t\treturn null;\r\n\t}\r\n\r\n\tstatic closeById(popId: string) {\r\n\t\tif (BoxyStore.managerHash[popId]) {\r\n\t\t\tlet pop = BoxyStore.managerHash[popId] as PopUp;\r\n\t\t\treturn pop.close();\r\n\t\t}\r\n\t\telse\r\n\t\t\treturn null;\r\n\t}\r\n}\r\n\r\nfunction wrapAsk(msg, cb, cfg) {\r\n\tif (typeof cb === 'function')\r\n\t\tcfg.callback = cb;\r\n\r\n\tif (!cfg.buttons) {\r\n\t\tcfg.buttons = {};\r\n\t}\r\n\r\n\tif (!cfg.buttons.ok) {\r\n\t\tcfg.buttons.ok = '确定';\r\n\t}\r\n\r\n\tlet html;\r\n\tif (typeof msg === 'string' && msg.indexOf('<iframe ') < 0) {\r\n\t\thtml = `<div class=\"dg-alert\">${msg}</div>`;\r\n\t}\r\n\telse html = msg;\r\n\r\n\treturn {html, cfg};\r\n}\r\n\r\n\r\nexport default PopUp;"]}